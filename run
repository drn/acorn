#!/bin/bash -eux

# ensure ~/downloads structure
mkdir -p ~/downloads
mkdir -p ~/downloads/blackhole
mkdir -p ~/downloads/misc
mkdir -p ~/downloads/movies
mkdir -p ~/downloads/pre-processed-tv
mkdir -p ~/downloads/safe
mkdir -p ~/downloads/tv
mkdir -p ~/downloads/torrents
mkdir -p ~/downloads/torrents/blackhole
mkdir -p ~/downloads/torrents/misc
mkdir -p ~/downloads/torrents/movies
mkdir -p ~/downloads/torrents/pre-processed-tv
mkdir -p ~/downloads/torrents/safe
mkdir -p ~/downloads/torrents/tv

# ensure ~/private/rtorrent structure
mkdir -p ~/private/rtorrent/data/blackhole
mkdir -p ~/private/rtorrent/data/misc
mkdir -p ~/private/rtorrent/data/movies
mkdir -p ~/private/rtorrent/data/pre-processed-tv
mkdir -p ~/private/rtorrent/data/safe
mkdir -p ~/private/rtorrent/data/tv

# ensure ~/.bash_*
cp -f ~/.acorn/profile ~/.bash_profile
cp -f ~/.acorn/aliases ~/.bash_aliases
cp -f ~/.acorn/gitconfig ~/.gitconfig

# ensure ~/rtorrent symlink exists
ln -sf ~/private/rtorrent ~

# ensure rtorrent version
echo -n '0.9.8_w0.13.8' > ~/private/rtorrent/.version

# ensure rtorrent.rc
cat ~/.acorn/rtorrent | \
  sed -re "s:/home/USERNAME:$HOME:" > \
  ~/.rtorrent.rc

# ensure rutorrent config.php
cd ~/www/*/public_html/rutorrent/conf/users
mkdir -p "$(whoami)"
cp ~/.acorn/rutorrent "$(whoami)/config.php"

# ensure rutorrent autotools config
cd ~/www/*/public_html/rutorrent/plugins/autotools
cp -f ~/.acorn/autotools conf.php
